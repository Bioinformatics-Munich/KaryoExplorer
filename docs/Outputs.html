<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>KaryoExplorer - Output Guide</title>
  <style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}

ul.task-list[class]{list-style: none;}
ul.task-list li input[type="checkbox"] {
font-size: inherit;
width: 0.8em;
margin: 0 0.8em 0.2em -1.6em;
vertical-align: middle;
}
.display.math{display: block; text-align: center; margin: 0.5rem auto;}
</style>
  <style type="text/css">body {
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
line-height: 1.6;
color: #24292e;
background-color: #f6f8fa;
max-width: 1200px;
margin: 0 auto;
padding: 40px 20px;
}
#TOC {
background-color: #ffffff;
border: 1px solid #d0d7de;
border-radius: 6px;
padding: 20px;
margin-bottom: 30px;
box-shadow: 0 1px 3px rgba(27,31,35,0.12);
position: relative;
}
#TOC h2 {
margin-top: 0;
color: #24292e;
font-size: 1.5em;
cursor: pointer;
user-select: none;
display: flex;
align-items: center;
justify-content: space-between;
}
#TOC h2:hover {
color: #0969da;
}
#TOC h2::after {
content: '▼';
font-size: 0.8em;
transition: transform 0.3s ease;
margin-left: 10px;
}
#TOC.collapsed h2::after {
transform: rotate(-90deg);
}
#TOC-content {
max-height: 600px;
overflow-y: auto;
transition: max-height 0.3s ease;
}
#TOC.collapsed #TOC-content {
max-height: 0;
overflow: hidden;
}
#TOC ul {
list-style-type: none;
padding-left: 20px;
}
#TOC li {
margin: 8px 0;
}
#TOC a {
color: #0969da;
text-decoration: none;
}
#TOC a:hover {
text-decoration: underline;
}
main {
background-color: #ffffff;
border: 1px solid #d0d7de;
border-radius: 6px;
padding: 45px;
box-shadow: 0 1px 3px rgba(27,31,35,0.12);
}
h1 {
border-bottom: 3px solid #2c3e50;
padding-bottom: 0.3em;
color: #2c3e50;
font-size: 2.5em;
margin-top: 24px;
margin-bottom: 16px;
}
h2 {
border-bottom: 2px solid #3498db;
padding-bottom: 0.3em;
color: #34495e;
font-size: 2em;
margin-top: 24px;
margin-bottom: 16px;
}
h3 {
color: #2980b9;
font-size: 1.5em;
margin-top: 24px;
margin-bottom: 16px;
}
h4 {
color: #27ae60;
font-size: 1.25em;
}
code {
background-color: #f6f8fa;
border: 1px solid #d0d7de;
border-radius: 3px;
font-size: 85%;
padding: 0.2em 0.4em;
font-family: ui-monospace, SFMono-Regular, Consolas, 'Liberation Mono', Menlo, monospace;
}
pre {
background-color: #f6f8fa;
border: 1px solid #d0d7de;
border-radius: 6px;
padding: 16px;
overflow: auto;
line-height: 1.45;
}
pre code {
background-color: transparent;
border: none;
padding: 0;
}
table {
border-collapse: collapse;
width: 100%;
margin: 20px 0;
box-shadow: 0 1px 3px rgba(27,31,35,0.1);
}
th {
background-color: #3498db;
color: white;
font-weight: 600;
padding: 12px;
text-align: left;
border: 1px solid #2980b9;
}
td {
padding: 12px;
border: 1px solid #d0d7de;
}
tr:nth-child(even) {
background-color: #f6f8fa;
}
tr:hover {
background-color: #e3f2fd;
}
blockquote {
background-color: #fff3cd;
border-left: 4px solid #ffc107;
padding: 15px 20px;
margin: 20px 0;
border-radius: 4px;
color: #856404;
}
a {
color: #0969da;
text-decoration: none;
}
a:hover {
text-decoration: underline;
}
hr {
border: 0;
border-top: 2px solid #d0d7de;
margin: 24px 0;
}
.version-info {
background-color: #d4edda;
border: 1px solid #c3e6cb;
border-left: 4px solid #28a745;
padding: 15px 20px;
margin: 20px 0;
border-radius: 4px;
color: #155724;
}
</style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">KaryoExplorer - Output Guide</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#digital-karyotyping-pipeline---output-guide" id="toc-digital-karyotyping-pipeline---output-guide">Digital Karyotyping
Pipeline - Output Guide</a>
<ul>
<li><a href="#overview" id="toc-overview">Overview</a></li>
<li><a href="#analysis-modes" id="toc-analysis-modes">Analysis
Modes</a></li>
<li><a href="#output-directory-structure" id="toc-output-directory-structure">Output Directory Structure</a></li>
<li><a href="#quick-start---your-main-results" id="toc-quick-start---your-main-results">Quick Start - Your Main
Results</a>
<ul>
<li><a href="#for-single-sample-analysis" id="toc-for-single-sample-analysis">For Single Sample Analysis:</a></li>
<li><a href="#for-paired-sample-analysis" id="toc-for-paired-sample-analysis">For Paired Sample Analysis:</a></li>
</ul></li>
<li><a href="#detailed-output-description" id="toc-detailed-output-description">Detailed Output Description</a>
<ul>
<li><a href="#information---pipeline-metadata" id="toc-information---pipeline-metadata">0.0_information - Pipeline
Metadata</a></li>
<li><a href="#quality_control---qc-metrics" id="toc-quality_control---qc-metrics">1.0_quality_control - QC
Metrics</a></li>
<li><a href="#preprocess---data-preprocessing" id="toc-preprocess---data-preprocessing">2.0_preprocess - Data
Preprocessing</a></li>
<li><a href="#sample_annotation" id="toc-sample_annotation">3.0_sample_annotation</a></li>
<li><a href="#roh_loh_analysis---runs-of-homozygosity-loss-of-heterozygosity" id="toc-roh_loh_analysis---runs-of-homozygosity-loss-of-heterozygosity">4.0_roh_loh_analysis
- Runs of Homozygosity &amp; Loss of Heterozygosity</a></li>
<li><a href="#karyoexplorer_preprocessing" id="toc-karyoexplorer_preprocessing">5.0_KaryoExplorer_preprocessing</a></li>
<li><a href="#karyoexplorer_single---interactive-single-sample-results" id="toc-karyoexplorer_single---interactive-single-sample-results">5.1_KaryoExplorer_single
- Interactive single Sample Results</a></li>
<li><a href="#karyoexplorer_paired---interactive-paired-sample-results" id="toc-karyoexplorer_paired---interactive-paired-sample-results">5.2_KaryoExplorer_paired
- Interactive Paired Sample Results</a></li>
</ul></li>
<li><a href="#table-headers-reference" id="toc-table-headers-reference">Table Headers Reference</a>
<ul>
<li><a href="#cnv-detection-tables" id="toc-cnv-detection-tables">CNV
Detection Tables</a></li>
</ul></li>
<li><a href="#analysis-workflow-summary" id="toc-analysis-workflow-summary">Analysis Workflow Summary</a>
<ul>
<li><a href="#single-mode-workflow" id="toc-single-mode-workflow">Single
Mode Workflow</a></li>
<li><a href="#paired-mode-workflow" id="toc-paired-mode-workflow">Paired
Mode Workflow</a></li>
</ul></li>
<li><a href="#usage-tips" id="toc-usage-tips">Usage Tips</a>
<ul>
<li><a href="#accessing-results" id="toc-accessing-results">Accessing
Results</a></li>
<li><a href="#data-analysis" id="toc-data-analysis">Data
Analysis</a></li>
<li><a href="#version-control" id="toc-version-control">Version
Control</a></li>
</ul></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul></li>
<li><a href="#software-versions" id="toc-software-versions">Software
Versions</a>
<ul>
<li><a href="#tools-used" id="toc-tools-used">Tools Used</a></li>
</ul></li>
</ul>
</nav>
<h1 id="digital-karyotyping-pipeline---output-guide">Digital Karyotyping
Pipeline - Output Guide</h1>
<h2 id="overview">Overview</h2>
<p>This pipeline detects Copy Number Variations (CNVs) and Runs of
Homozygosity (ROH) using Illumina arrays. It is a Nextflow DSL2
implementation of the Digital Karyotyping pipeline originally developed
at MPI (Prof. Binder).</p>
<p><strong>Purpose</strong>: Detect de novo copy number abnormalities
arising in cultured cell lines to determine differences between cell
lines and their starting material. This genomic screening for
chromosomal abnormalities serves as quality control to establish and
maintain stem cell lines.</p>
<p><strong>Original repository</strong>:
https://gitlab.mpcdf.mpg.de/luciat/cnv_detection</p>
<hr />
<h2 id="analysis-modes">Analysis Modes</h2>
<p>The pipeline supports two analysis modes:</p>
<ul>
<li><strong>Single Mode</strong>: Analyzes individual samples to
identify CNV and ROH patterns within each sample</li>
<li><strong>Paired Mode</strong>: Compares POST samples against PRE
reference samples to identify differential CNV and ROH patterns between
conditions</li>
</ul>
<p><strong>Naming Convention</strong>: For paired workflows, outputs use
<code>PRE_POST</code> naming format (e.g.,
<code>PRE_Sample1_POST_Sample2</code>).</p>
<hr />
<h2 id="output-directory-structure">Output Directory Structure</h2>
<p>The pipeline generates a well-organized output directory with the
following structure:</p>
<pre><code>results/
├── README.html                              # This documentation file
├── 0.0_information/                         # Pipeline metadata and logs
│   ├── 0.1_pipeline_logs/                   # Process-specific log files
│   │   ├── 5.1_KaryoExplorer_single_logs/
│   │   └── 5.2_KaryoExplorer_paired_logs/
│   ├── 0.2_versions/                        # Software version information
│   │   ├── bcftools.version.txt
│   │   ├── plink.version.txt
│   │   └── vcftools.version.txt
│   └── 0.3_reports/                         # Pipeline parameter reports
│       ├── pipeline_parameters.json
│       └── parameter_report.md
├── 1.0_quality_control/                     # Quality control results
│   ├── 1.1_QC_results/                      # QC metrics and tables
│   ├── 1.2_single_matching/                 # Single sample genotype matching
│   ├── 1.3_paired_matching/                 # Paired sample genotype matching
│   └── 1.4_IBD_Analysis/                    # Identity by descent analysis
├── 2.0_preprocess/                          # Data preprocessing
│   ├── 2.1_manifest_reference/              # Manifest reference alleles
│   ├── 2.2_plink/                           # PLINK format conversion
│   ├── 2.3_plink_corrected/                 # Reference allele corrected VCF
│   └── 2.4_preprocess_vcf/                  # BAF/LRR annotated VCF
├── 3.0_sample_annotation/                   # Sample metadata and annotations
├── 4.0_roh_loh_analysis/                    # Runs of Homozygosity &amp; Loss of Heterozygosity
│   ├── 4.1_roh_loh_single/                  # Single sample ROH/LOH analysis
│   └── 4.2_roh_loh_paired/                  # Paired sample ROH/LOH analysis
├── 5.0_KaryoExplorer_preprocessing/            # Data preparation for visualization
├── 5.1_KaryoExplorer_single/                 # Interactive single sample results
└── 5.2_KaryoExplorer_paired/                   # Interactive paired sample results</code></pre>
<hr />
<h2 id="quick-start---your-main-results">Quick Start - Your Main
Results</h2>
<p><strong>Looking for your analysis results? Start here!</strong></p>
<p>The pipeline generates comprehensive outputs organized across
multiple directories, but the <strong>main interactive results</strong>
you’ll want to access are:</p>
<h3 id="for-single-sample-analysis">For Single Sample Analysis:</h3>
<p>Navigate to <strong><code>5.1_KaryoExplorer_single/</code></strong>
and open <code>KaryoExplorer.html</code> in your web browser (Chrome
recommended).</p>
<p><strong>What you’ll find:</strong></p>
<ul>
<li><p>Interactive visualization of all your single sample CNV and ROH
results in one place</p></li>
<li><p>Chromosome-by-chromosome exploration with interactive
plots</p></li>
<li><p>Sample quality metrics and summary statistics</p></li>
<li><p>All analysis results combined into an easy-to-navigate
interface</p></li>
</ul>
<h3 id="for-paired-sample-analysis">For Paired Sample Analysis:</h3>
<p>Navigate to <strong><code>5.2_KaryoExplorer_paired/</code></strong>
and open <code>KaryoExplorer.html</code> in your web browser (Chrome
recommended).</p>
<p><strong>What you’ll find:</strong></p>
<ul>
<li><p>Side-by-side comparison of PRE vs POST samples</p></li>
<li><p>Differential CNV and ROH analysis showing changes between
conditions</p></li>
<li><p>Interactive paired sample visualizations</p></li>
<li><p>All paired analysis results in one comprehensive
interface</p></li>
</ul>
<blockquote>
<p><strong>Tip</strong>: These interactive HTML applications contain all
your pipeline results in a user-friendly format.</p>
</blockquote>
<blockquote>
<p><strong>⚠️ Important</strong>: Keep the HTML file in the same
directory as the <code>samples/</code> and <code>components/</code>
folders for proper functionality.</p>
</blockquote>
<hr />
<h2 id="detailed-output-description">Detailed Output Description</h2>
<h3 id="information---pipeline-metadata">0.0_information - Pipeline
Metadata</h3>
<p>Contains all pipeline execution information, logs, and software
versions.</p>
<h4 id="pipeline_logs">0.1_pipeline_logs</h4>
<ul>
<li><strong>Purpose</strong>: Process-specific log files for debugging
and tracking</li>
<li><strong>Subdirectories</strong>:
<ul>
<li><code>5.1_KaryoExplorer_single_logs/</code>: Logs from single sample
visualization</li>
<li><code>5.2_KaryoExplorer_paired_logs/</code>: Logs from paired sample
visualization</li>
</ul></li>
</ul>
<h4 id="versions">0.2_versions</h4>
<ul>
<li><strong>Purpose</strong>: Software version tracking for
reproducibility</li>
<li><strong>Files</strong>:
<ul>
<li><code>bcftools.version.txt</code>: BCFtools version used</li>
<li><code>plink.version.txt</code>: PLINK version used</li>
<li><code>vcftools.version.txt</code>: VCFtools version used</li>
</ul></li>
</ul>
<h4 id="reports">0.3_reports</h4>
<ul>
<li><strong>Purpose</strong>: Pipeline configuration and parameter
documentation</li>
<li><strong>Files</strong>:
<ul>
<li><code>pipeline_parameters.json</code>: All pipeline parameters in
JSON format</li>
<li><code>parameter_report.md</code>: Human-readable parameter summary
in Markdown</li>
</ul></li>
</ul>
<hr />
<h3 id="quality_control---qc-metrics">1.0_quality_control - QC
Metrics</h3>
<p>Quality control analysis and filtering results. See the <a href="https://gitlab.mpcdf.mpg.de/luciat/cnv_detection/-/blob/master/pipeline_description/Genotyping_Data_QC.pdf">original
manual</a> for details on SNP filtering methodology.</p>
<h4 id="qc_results">1.1_QC_results</h4>
<ul>
<li><strong>Key Files</strong>:
<ul>
<li><code>Samples_Table_filt_QC.tsv</code>: Call rates per sample
before/after filtering and LRR standard deviations</li>
<li><code>GT_comp.tsv</code>: Matrix of all genotype correlations</li>
<li><code>plot_CR_samples.pdf/png</code>: Call rate visualization
plots</li>
<li><code>BAF_table.txt</code>, <code>LRR_table.txt</code>: B-allele
frequency and Log R Ratio tables</li>
</ul></li>
</ul>
<blockquote>
<p><strong>Note</strong>: LRR standard deviations &gt; 0.3 may indicate
increased variability and potential sample quality issues.</p>
</blockquote>
<h4 id="single_matching">1.2_single_matching</h4>
<ul>
<li><strong>Purpose</strong>: Genotype matching results for single
samples</li>
<li><strong>Key Files</strong>:
<ul>
<li><code>GT_samples_comp.tsv</code>: Genotype correlation matrix for
single samples</li>
<li><code>hm_GT.pdf/png</code>: Heatmap visualization of genotype
matches</li>
<li><code>annotation_file_GTmatch.csv</code>: Genotype matching
annotations</li>
</ul></li>
</ul>
<h4 id="paired_matching">1.3_paired_matching</h4>
<ul>
<li><strong>Purpose</strong>: Genotype matching results for paired
samples</li>
<li><strong>Key Files</strong>:
<ul>
<li><code>GT_samples_comp.tsv</code>: Genotype correlation matrix for
paired samples</li>
<li><code>hm_GT.pdf/png</code>: Heatmap visualization of genotype
matches</li>
<li><code>annotation_file_GTmatch.csv</code>: Genotype matching
annotations</li>
</ul></li>
</ul>
<h4 id="ibd_analysis">1.4_IBD_Analysis</h4>
<ul>
<li><strong>Purpose</strong>: Identity by descent analysis results</li>
<li><strong>Key Files</strong>:
<ul>
<li><code>paired_sample_with_pi_hat.csv</code>: PI_HAT values for paired
samples (relatedness coefficient)</li>
<li><code>sample_types_single_w_QC.csv</code>: Single sample metadata
with QC metrics</li>
</ul></li>
</ul>
<hr />
<h3 id="preprocess---data-preprocessing">2.0_preprocess - Data
Preprocessing</h3>
<p>All preprocessing steps from raw genotype data to annotated VCF
files.</p>
<h4 id="manifest_reference">2.1_manifest_reference</h4>
<ul>
<li><strong>Purpose</strong>: Manifest reference alleles extraction</li>
<li><strong>Files</strong>: <code>*.ref</code> files containing
reference allele information per SNP</li>
</ul>
<h4 id="plink">2.2_plink</h4>
<ul>
<li><strong>Purpose</strong>: PLINK format conversion from array
data</li>
<li><strong>Key Files</strong>:
<ul>
<li><code>plink.vcf</code>: Converted VCF file</li>
<li><code>plink.log</code>: Conversion log</li>
<li><code>plink.nosex</code>: Sample sex information</li>
</ul></li>
</ul>
<h4 id="plink_corrected">2.3_plink_corrected</h4>
<ul>
<li><strong>Purpose</strong>: Reference allele correction using manifest
data</li>
<li><strong>Files</strong>: <code>plink_corrected.vcf</code> - VCF with
corrected reference alleles</li>
</ul>
<h4 id="preprocess_vcf">2.4_preprocess_vcf</h4>
<ul>
<li><strong>Purpose</strong>: BAF and LRR annotation of VCF</li>
<li><strong>Key Files</strong>:
<ul>
<li><code>data_BAF_LRR.vcf</code>: VCF annotated with B-allele frequency
and Log R Ratio</li>
<li><code>SNPs_QC.txt</code>: List of QC-passed SNPs (chromosome,
position, ID)</li>
</ul></li>
</ul>
<hr />
<h3 id="sample_annotation">3.0_sample_annotation</h3>
<p>Sample annotation files including metadata, sex determination, and
sample relationships.</p>
<p><strong>Key Files</strong>: - <code>*.tsv</code>: Sample annotation
tables with metadata - Sample type classifications and relationships</p>
<hr />
<h3 id="roh_loh_analysis---runs-of-homozygosity-loss-of-heterozygosity">4.0_roh_loh_analysis
- Runs of Homozygosity &amp; Loss of Heterozygosity</h3>
<p>ROH and LOH detection using bcftools algorithm, with overlap analysis
between CNV and ROH regions.</p>
<h4 id="roh_loh_single">4.1_roh_loh_single</h4>
<ul>
<li><strong>Purpose</strong>: ROH/LOH analysis for individual
samples</li>
<li><strong>Structure</strong>:
<ul>
<li><code>{SAMPLE_NAME}/bcftools_algorithm/</code>: ROH detection
results</li>
<li><code>{SAMPLE_NAME}/overlap/</code>: Combined CNV-ROH analysis</li>
</ul></li>
<li><strong>Key Files</strong>:
<ul>
<li><code>*_roh.bed</code>: ROH regions in BED format</li>
<li><code>*_cn_with_length.bed</code>: Copy number regions with
length</li>
<li><code>*_union_merged_with_length.bed</code>: Merged CNV and ROH
regions</li>
<li>Summary tables and statistics</li>
</ul></li>
</ul>
<h4 id="roh_loh_paired">4.2_roh_loh_paired</h4>
<ul>
<li><strong>Purpose</strong>: Differential ROH/LOH analysis for paired
samples</li>
<li><strong>Structure</strong>: Similar to single mode with PRE, POST,
and differential analysis</li>
<li><strong>Key Files</strong>:
<ul>
<li>Pre-sample ROH results</li>
<li>Post-sample ROH results</li>
<li>Differential analysis showing changes between PRE and POST</li>
</ul></li>
</ul>
<hr />
<h3 id="karyoexplorer_preprocessing">5.0_KaryoExplorer_preprocessing</h3>
<p>Standardized data collection and formatting for interactive
visualization.</p>
<p><strong>Purpose</strong>: Collects all analysis results and
standardizes them as CSV files for the interactive visualization
tool.</p>
<p><strong>Structure</strong>:</p>
<ul>
<li><p><code>single/{SAMPLE_NAME}/processed/</code>: Single sample
processed data</p></li>
<li><p><code>paired/{PRE_POST_ID}/processed/</code>: Paired sample
processed data</p></li>
</ul>
<p><strong>Single Sample Files</strong>:</p>
<ul>
<li><p><code>single_baf_lrr_data_*.csv</code>: BAF and LRR data
points</p></li>
<li><p><code>single_cn_bed_*.csv</code>: Copy number regions in BED
format</p></li>
<li><p><code>single_cn_probabilities_data_*.csv</code>: Copy number
probability distributions</p></li>
<li><p><code>single_cn_summary_data_*.csv</code>: Copy number summary
statistics</p></li>
<li><p><code>single_cnv_chromosomes_*.csv</code>: CNV data organized by
chromosome</p></li>
<li><p><code>single_cnv_detection_filtered_*.csv</code>: Filtered CNV
detection results</p></li>
<li><p><code>single_roh_bed_*.csv</code>: ROH regions in BED
format</p></li>
<li><p><code>single_union_bed_*.csv</code>: Combined CNV and ROH
regions</p></li>
</ul>
<p><strong>Paired Sample Files</strong>:</p>
<ul>
<li><p><code>combined_cn_bed_*.csv</code>: Combined copy number data
(PRE + POST)</p></li>
<li><p><code>combined_cnv_chromosomes_*.csv</code>: Combined CNV by
chromosome</p></li>
<li><p><code>combined_cnv_detection_filtered_*.csv</code>: Combined
filtered CNV results</p></li>
<li><p><code>combined_roh_bed_*.csv</code>: Combined ROH data</p></li>
<li><p><code>combined_union_bed_*.csv</code>: Combined CNV and ROH
regions</p></li>
<li><p><code>pre_*</code> files: Individual PRE sample data</p></li>
<li><p><code>post_*</code> files: Individual POST sample data</p></li>
</ul>
<hr />
<h3 id="karyoexplorer_single---interactive-single-sample-results">5.1_KaryoExplorer_single
- Interactive single Sample Results</h3>
<p><strong>This is your main result for single sample
analysis!</strong></p>
<p><strong>Purpose</strong>: Interactive HTML-based visualization for
exploring CNV and ROH patterns in individual samples.</p>
<p><strong>How to Access</strong>: 1. Open
<code>KaryoExplorer.html</code> in a web browser (Chrome recommended) 2.
Click the <strong>ℹ</strong> (info) icon for detailed usage instructions
3. Navigate through samples and chromosomes using the interactive
interface</p>
<p><strong>Key Features</strong>:</p>
<ul>
<li><p>Chromosome-specific visualizations with interactive
plots</p></li>
<li><p>CNV and ROH region exploration</p></li>
<li><p>Sample summary pages with quality metrics</p></li>
<li><p>Karyotype overview plots</p></li>
<li><p>Downloadable data tables</p></li>
</ul>
<blockquote>
<p><strong>⚠️ Important</strong>: The HTML file must remain in the same
directory as <code>samples/</code> and <code>components/</code> folders
to function properly.</p>
</blockquote>
<hr />
<h3 id="karyoexplorer_paired---interactive-paired-sample-results">5.2_KaryoExplorer_paired
- Interactive Paired Sample Results</h3>
<p><strong>This is your main result for paired sample
analysis!</strong></p>
<p><strong>Purpose</strong>: Interactive HTML-based visualization for
exploring differential CNV and ROH patterns between PRE and POST
samples.</p>
<p><strong>How to Access</strong>: 1. Open
<code>KaryoExplorer.html</code> in a web browser (Chrome recommended) 2.
Click the <strong>ℹ</strong> (info) icon for detailed usage instructions
3. Explore differential patterns between sample pairs</p>
<p><strong>Key Features</strong>:</p>
<ul>
<li><p>Side-by-side PRE/POST comparison</p></li>
<li><p>Differential CNV detection (gains/losses between
conditions)</p></li>
<li><p>Differential ROH analysis</p></li>
<li><p>Interactive chromosome-level visualizations</p></li>
<li><p>Pair summary statistics and quality metrics</p></li>
</ul>
<blockquote>
<p><strong>⚠️ Important</strong>: The HTML file must remain in the same
directory as <code>samples/</code> and <code>components/</code> folders
to function properly.</p>
</blockquote>
<hr />
<h2 id="table-headers-reference">Table Headers Reference</h2>
<h3 id="cnv-detection-tables">CNV Detection Tables</h3>
<table>
<colgroup>
<col style="width: 38%" />
<col style="width: 61%" />
</colgroup>
<thead>
<tr>
<th>Column</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Chr</code></td>
<td>Chromosome number</td>
</tr>
<tr>
<td><code>Start</code></td>
<td>Start position (genomic coordinates)</td>
</tr>
<tr>
<td><code>End</code></td>
<td>End position (genomic coordinates)</td>
</tr>
<tr>
<td><code>CN_post</code></td>
<td>Copy number in POST sample</td>
</tr>
<tr>
<td><code>CN_pre</code></td>
<td>Copy number in PRE sample</td>
</tr>
<tr>
<td><code>QS</code></td>
<td>Quality score (<a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0155014">Danecek
et al.</a>)</td>
</tr>
<tr>
<td><code>nSites_post</code></td>
<td>Number of SNP markers in POST sample</td>
</tr>
<tr>
<td><code>nHets_post</code></td>
<td>Number of heterozygous markers in POST sample</td>
</tr>
<tr>
<td><code>nSites_pre</code></td>
<td>Number of SNP markers in PRE sample</td>
</tr>
<tr>
<td><code>nHets_pre</code></td>
<td>Number of heterozygous markers in PRE sample</td>
</tr>
<tr>
<td><code>Len</code></td>
<td>Length of region in base pairs (End - Start)</td>
</tr>
<tr>
<td><code>pre</code></td>
<td>PRE sample name</td>
</tr>
<tr>
<td><code>post</code></td>
<td>POST sample name</td>
</tr>
<tr>
<td><code>type</code></td>
<td>Event type: Deletion or Duplication</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="analysis-workflow-summary">Analysis Workflow Summary</h2>
<h3 id="single-mode-workflow">Single Mode Workflow</h3>
<ol type="1">
<li>Quality Control (<code>1.0_quality_control/</code>)</li>
<li>Data Preprocessing (<code>2.0_preprocess/</code>)</li>
<li>Sample Annotation (<code>3.0_sample_annotation/</code>)</li>
<li>ROH/LOH Analysis
(<code>4.0_roh_loh_analysis/4.1_roh_loh_single/</code>)</li>
<li>Data Preparation
(<code>5.0_KaryoExplorer_preprocessing/</code>)</li>
<li><strong>Interactive Results</strong>
(<code>5.1_KaryoExplorer_single/</code>)</li>
</ol>
<h3 id="paired-mode-workflow">Paired Mode Workflow</h3>
<ol type="1">
<li>Quality Control (<code>1.0_quality_control/</code>)</li>
<li>Data Preprocessing (<code>2.0_preprocess/</code>)</li>
<li>Sample Annotation (<code>3.0_sample_annotation/</code>)</li>
<li>ROH/LOH Analysis
(<code>4.0_roh_loh_analysis/4.2_roh_loh_paired/</code>)</li>
<li>Data Preparation
(<code>5.0_KaryoExplorer_preprocessing/</code>)</li>
<li><strong>Interactive Results</strong>
(<code>5.2_KaryoExplorer_paired/</code>)</li>
</ol>
<hr />
<h2 id="usage-tips">Usage Tips</h2>
<h3 id="accessing-results">Accessing Results</h3>
<ul>
<li><strong>Quick Start</strong>: Open the main <code>README.html</code>
(this file) for an overview, then navigate to
<code>5.1_KaryoExplorer_single/</code> or
<code>5.2_KaryoExplorer_paired/</code> for interactive results</li>
<li><strong>Browser Compatibility</strong>: Chrome is recommended for
best performance</li>
<li><strong>File Integrity</strong>: Do not move HTML files outside
their directories; they depend on relative paths to
<code>components/</code> and <code>samples/</code> folders</li>
</ul>
<h3 id="data-analysis">Data Analysis</h3>
<ul>
<li>All output files are tab-delimited or CSV format for easy import
into R, Python, or Excel</li>
<li>Interactive plots allow zooming, panning, and detailed inspection of
specific regions</li>
<li>Summary statistics are available in both the interactive interface
and as downloadable tables</li>
</ul>
<h3 id="version-control">Version Control</h3>
<ul>
<li>All software versions are logged in
<code>0.0_information/0.2_versions/</code></li>
<li>Pipeline parameters are documented in
<code>0.0_information/0.3_reports/</code></li>
<li>This ensures full reproducibility of results</li>
</ul>
<h2 id="references">References</h2>
<ol type="1">
<li><p>Danecek P, et al. (2016) <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0155014">BCFtools/RoH:
a hidden Markov model approach for detecting autozygosity from
next-generation sequencing data</a>. PLoS ONE 11(4): e0155014.</p></li>
<li><p>Original CNV Detection Pipeline:
https://gitlab.mpcdf.mpg.de/luciat/cnv_detection</p></li>
</ol>
<hr />
<p><strong>Pipeline Version</strong>: 2.0<br />
<strong>Last Updated</strong>: 2025</p>
<h1 id="software-versions">Software Versions</h1>
<p><strong>Generated on:</strong> Tue Dec 30 06:02:06 CET 2025</p>
<h2 id="tools-used">Tools Used</h2>
<ul>
<li><strong>R Version:</strong></li>
</ul>
<pre><code>R version 4.3.3 (2024-02-29) -- &quot;Angel Food Cake&quot;</code></pre>
<ul>
<li><strong>PLINK Version:</strong></li>
</ul>
<pre><code>PLINK v1.90b6.21 64-bit (19 Oct 2020)</code></pre>
<ul>
<li><strong>BCFtools Version:</strong></li>
</ul>
<pre><code>bcftools 1.20</code></pre>
<ul>
<li><strong>VCFtools Version:</strong></li>
</ul>
<pre><code>VCFtools (0.1.16)</code></pre>
<script>
</html>
document.addEventListener('DOMContentLoaded', function() {
    var toc = document.getElementById('TOC');
    if (toc) {
        // Wrap TOC content
        var tocH2 = toc.querySelector('h2');
        var tocContent = document.createElement('div');
        tocContent.id = 'TOC-content';
        
        // Move all children after h2 into the content div
        var children = Array.from(toc.children);
        children.forEach(function(child) {
            if (child !== tocH2) {
                tocContent.appendChild(child);
            }
        });
        toc.appendChild(tocContent);
        
        // Add click handler to h2
        tocH2.addEventListener('click', function() {
            toc.classList.toggle('collapsed');
        });
        
        // Add title attribute for hint
        tocH2.title = 'Click to expand/collapse';
    }
});
</script>
</body>
</html>

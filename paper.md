---
title: 'KaryoExplorer: An Automated Digital Karyotyping Pipeline with Interactive Visualizations'
tags:
  - Digital Karyotyping
  - bioinformatics
  - CNV
  - Stem Cells
  - Quality Control
  - loss of heterozygosity
  - nextflow
  - visualization
authors:
  - name: Ugur Dura
    orcid: 0009-0004-1139-4997
    affiliation: 1
  - name: Xavier Pastor Hostench
    orcid: 0000-0003-2089-3777
    affiliation: "2"
  - name: Peter Lichtner
    orcid: 0000-0001-5981-7996
    affiliation: "2"
  - name: Alena Boos
    orcid: 0000-0001-5909-5110
    corresponding: true
    affiliation: 1
  - name: Thomas Walzthoeni
    orcid: 0009-0009-3995-709X
    corresponding: true
    affiliation: 1
affiliations:
  - name: Core Facility Bioinformatics and Statistics, Helmholtz Zentrum München GmbH - German Research Center for Environmental Health, 85764 Neuherberg, Germany
    index: 1
  - name: Core Facility Genomics, Helmholtz Zentrum München GmbH - German Research Center for Environmental Health, 85764 Neuherberg, Germany
    index: 2
date: 02 June 2025
bibliography: paper.bib
---

# Summary

Induced pluripotent stem cells (iPSCs) are generated for a wide variety of experiments and applications [@Takahashi2006_Cell; @Takahashi2007_Cell]. To ensure high quality of the generated iPSCs a routine quality control (QC) is performed including screening for copy number variation (CNV) and loss of heterozygosity (LoH). Researchers often have to use multiple tools, manual file handling, and static plots to interpret the results [@Laurent2011_CellStemCell; @Assou2018_StemCells].

KaryoExplorer is a Nextflow-based computational pipeline that performs CNV and LoH analysis on Illumina genotyping arrays and provides a single, self-contained and interactive HyperText Markup Language (HTML) report [@DiTommaso2017_NBT]. It integrates CNV calls (deletions/duplications) and runs of homozygosity (ROH) to surface candidate copy-neutral LoH (cnLoH). The HTML report presents synchronized B-allele frequency (BAF), log-R ratio (LRR), and copy number (CN) visualizations enabling investigation on base level for each chromosome in addition to genome-wide karyotype maps and QC summaries. The report can be accessed using a web browser without the need for any additional software.



# Statement of need

iPSCs are generated by reprogramming adult somatic cells through the introduction of key pluripotency factors (Yamanaka Factors) such as Oct4, Sox2, Klf4, and c-Myc [@Takahashi2006_Cell; @Takahashi2007_Cell]. These cells have opened new avenues for regenerative medicine, disease modeling, and drug discovery due to their ability to differentiate into various specialized cell types. However, a major concern is their genomic instability, which can occur during the reprogramming process or throughout differentiation. Such genomic abnormalities, particularly CNVs, can significantly impact the safety, reproducibility, and therapeutic potential of iPSC-derived cell lines [@Laurent2011_CellStemCell; @Assou2018_StemCells].

Routine genomic screening is an essential quality control for iPSC-based cell lines [@Danecek2016_PLOSOne].  Monitoring for CNVs and other chromosomal aberrations is used to probe the genomic integrity of the cell lines. While traditional karyotyping methods (e.g. G-banding) are widely used, they often lack the resolution and efficiency required for high-throughput applications [@Lund2012_StemCellRes]. In contrast, digital karyotyping provides a robust alternative by using genotyping arrays to detect CNVs at higher resolution [@Danecek2016_PLOSOne]. Despite this progress, current digital karyotyping workflows remain fragmented and inconsistent across laboratories. Researchers typically compute CNVs and ROH/LoH using different tools, requiring manual validation and inspection of events. This slows down the QC process, complicates sharing of the results and may undermine reproducibility.

KaryoExplorer directly overcomes these limitations by providing an integrated, reproducible, and interactive solution. It automates preprocessing, CNV and ROH inference, candidate cnLoH highlighting, and provides several QC metrics. The results are compiled into an interactive HTML report. Each page provides a one-click "Print to PDF" button that preserves the current interactive state (such as zoomed Bokeh plots) (Figure \ref{fig:homepage}). All Bokeh figures also support built-in PNG export for publication ready figures [@Bokeh2018]. 



# State of the field

Single nucleotide polymorphism (SNP) genotyping arrays such as Illumina Infinium Global Screening Array (GSA) and Thermo Fisher Axiom are a common way to analyze CNV and LoH events within digital karyotyping field. Popular tools such as PennCNV and QuantiSNP use two signals from the arrays: LRR (a measure of intensity) and BAF (a measure of genotype balance) [@Wang2007_PennCNV; @Colella2007_QuantiSNP; @vanBaardwijk2024_Genomics]. While PennCNV and QuantiSNP are effective for CNV detection, they are primarily designed for single-sample analysis and lack integrated support for several key features: they provide limited functionality for systematically identifying cnLoH events, require additional scripting to generate coordinated BAF/LRR visualizations alongside CNV calls, and do not natively support paired-sample comparisons (for example, comparing a tumor to normal tissue, or an iPSC clone to its parental line). Specialized methods like ASCAT address paired allele-specific copy number in cancer, but they target a different use case and ecosystem [@VanLoo2010_PNAS_ASCAT].

Visualization is equally important in cytogenetics and QC workflows, where interpretable, chromosome-by-chromosome views guide decisions. Graphical user interface (GUI) tools like Illumina GenomeStudio/KaryoStudio, Partek Genomics Suite, and Agilent Cytogenomics provide helpful karyograms and per-chromosome BAF/LRR plots [@Illumina_cnvPartition; @GenomeStudio_Docs; @ChAS_Manual; @NexusCopyNumber]. However, these tools are not open source and often tied to specific setups, which can impair reproducibility. Research laboratories therefore often use a mix of in-house pipelines and Integrative Genomics Viewer (IGV) or custom plotting for genome visualization, as a result fragmenting analysis and interpretation [@Robinson2025_bioRxiv]. KaryoExplorer bridges this gap with centralized, self-contained interactive visualizations accessible through any web browser. 

# Functionality

## Core Analytical Components

KaryoExplorer directly addresses the limitations of fragmented digital karyotyping workflows. For CNV calling, KaryoExplorer uses bcftools cnv, which models both BAF and LRR signals, includes a polysomy mode, and performs effectively for identifying differences between related samples which is ideal approach for paired analyses [@Danecek2016_PLOSOne]. For ROH detection, bcftools roh identifies long homozygous tracts consistent with LoH [@Narasimhan2016_Bioinformatics]. The pipeline automatically overlays ROH with copy-number states, ROH inside diploid (CN=2) regions are flagged as candidate cnLoH, while ROH overlapping CN<2 are labeled as copy-loss LoH (Figure \ref{fig:chr_view}). This integrated approach simplifies interpretation for researchers and represents a unique advantage compared to other tools, which typically require manual cross-referencing of CNV and ROH outputs.


## Visualization and Reporting


The unified visualization and reporting framework further enhance accessibility and interpretability of genomic integrity assessments by providing an integrated, reproducible, and interactive framework. It automates preprocessing, CNV and ROH inference, candidate cnLoH highlighting, and generation of QC metrics within a single pipeline (Figure \ref{fig:chr_view}). The resulting compact self-contained interactive HTML report consolidates karyograms, synchronized BAF/LRR/CN tracks, and cnLoH region highlights that helps investigators to directly examine supporting evidence rather than rely solely on automated calls (Figure \ref{fig:paired_karyograms}). Each report includes built-in QC dashboards, one-click PDF export preserving the interactive state, and PNG export for publication ready figures (Figure \ref{fig:homepage}). Researchers can open this report directly in any modern browser without special software and explore both single and paired analyses within the same layout, facilitating transparent review, sharing, and reproducible interpretation.


## Technical Implementation and Reproducibility

Under the hood, the pipeline is implemented in Nextflow DSL2 and distributed through containerized environments to ensure reproducibility across compute infrastructures [@DiTommaso2017_NBT; @Merkel2014_LinuxJournal; @Dykstra2022_Apptainer]. The workflow provides consistent single and paired sample analysis modes which includes automatic software version tracking and supports high performance computing (HPC) environments.

- Single-sample and paired (PRE$\rightarrow$POST) analysis with differential views and event summaries (Figure \ref{fig:chr_view}).
- CNV detection (deletions, duplications) from BAF/LRR segmentation with segment statistics and quality scores (Figure \ref{fig:chr_view}).
- ROH and LoH inference with cnLoH assignment (Figure \ref{fig:chr_view}).
- Interactive multi-page HTML report: genome-wide karyograms; synchronized BAF/LRR/CN per chromosome; candidate cnLoH highlighting; QC dashboards; searchable/exportable tables (Figure \ref{fig:paired_karyograms}). 
- Exportability for review and publication: per-page print to PDF (preserves current zoom/selection) and built-in Portable Network Graphics (PNG) export on each plot (Figure \ref{fig:homepage}).
- Reproducibility: Nextflow DSL2 + containers (Apptainer/Singularity, Docker); automatic capture of software versions, parameters, and resources; portable artifacts. 

![Interactive HTML report homepage. The self-contained report displays navigation menu, QC summary metrics, and sample overview for paired PRE$\rightarrow$POST analysis. The report runs locally in any modern web browser without additional software dependencies. Figure is created via Whimsical. \label{fig:homepage}](figures/Home_Page.png){ width=75% }

![Genome-wide karyograms in paired analysis mode. CNV segments are color coded (deletions in blue, duplications in red) with circle size indicating event magnitude (base pair) and opacity reflecting statistical significance (p-value). The synchronized PRE (donor) and POST (iPSC) views facilitate rapid identification of acquired chromosomal alterations. Test data are presented for demonstration purposes to illustrate a range of event types.\label{fig:paired_karyograms}](figures/pre_post_diff_karyograms.png){ width=75% }

![Chromosome level visualization of BAF, LRR, and copy number tracks in paired mode (Zoomed to position 180-220 Mb). Interactive plots enable pan-and-zoom navigation with synchronized views of PRE, POST and their differential view. ROH segments(green) and candidate cnLOH regions are highlighted; LRR plots overlay segment boundaries and mean values (orange) to aid deviation assessment. The differential view integrates both samples for direct comparison of genomic events (Duplication event that shown with red borders in this example).\label{fig:chr_view}](figures/pre_post_LRR_BAF.png)

# Availability

KaryoExplorer is hosted on a publicly available GitHub repository (https://github.com/Bioinformatics-Munich/KaryoExplorer). The repository includes detailed documentations, setup, configuration guide and a demo dataset (Source: Illumina 2024 Infinium Global Screening Array v4.0 Used under license from Illumina, Inc. All Rights Reserved). The pipeline has been tested on a HPC Cluster, Linux, macOS (including Apple Silicon), and Windows. 

# Acknowledgements

We acknowledge Dr. Laura Jiménez Barrón, Dr. Lucia Trastulla, and Dr. Michael Ziller for earlier development contributions. We are grateful to Prof. Dr. Elisabeth Binder and the Binder Lab at the Max Planck Institute of Psychiatry, as well as Dr. Ejona Rusha (Head of Core Facility Induced Pluripotent Stem Cells, Helmholtz Zentrum München) for their guidance and support. 

# References
---
title: 'KaryoPlayground: An Interactive Pipeline for Digital Karyotyping with CNV and LoH Detection'
tags:
  - genomics
  - bioinformatics
  - CNV
  - loss of heterozygosity
  - nextflow
  - visualization
authors:
  - name: Ugur Dura
    orcid: 0000-0000-0000-0000
    affiliation: 1
affiliations:
  - name: Technical University of Munich, MSc Informatics Student
    index: 1
date: 2025-09-12
bibliography: paper.bib
---

# Summary
<!-- <<Briefly (1–2 paragraphs) describe the problem and the solution.>> -->

Induced pluripotent stem cells (iPSCs) are powerful but genomically fragile models [@Takahashi2006_Cell; @Takahashi2007_Cell]. Routine screening for copy number variation (CNV) and loss of heterozygosity (LoH) is essential, yet labs often juggle multiple tools, manual file wrangling, and non-shareable plots to interpret results [@Hussein2011_Nature; @Laurent2011_CellStemCell; @Mayshar2010_CellStemCell].

KaryoPlayground is a Nextflow-based, containerized pipeline that performs CNV and LoH analysis from Illumina genotyping array outputs and delivers a single, self-contained interactive HTML report [@DiTommaso2017_NBT]. It integrates CNV calls (deletions/duplications) and runs-of-homozygosity to surface candidate copy-neutral LoH, and presents synchronized BAF/LRR/CN visualizations that users can zoom in and navigate through for each chromosome, genome-wide karyotype maps, and QC summaries [@Bokeh2018]. Results can be accessed in any browser, offline, with no extra software.

# Statement of need

<!-- <<Who needs this tool and why?  
- Why existing methods are insufficient?
Keep it 1–2 paragraphs.>> -->

iPSCs are generated by reprogramming adult somatic cells through the introduction of key
pluripotency factors (aka Yamanaka Factors) such as Oct4, Sox2, Klf4, and c-Myc [@Takahashi2006_Cell; @Takahashi2007_Cell]. These
cells have opened new advantages in regenerative medicine, disease modeling, and drug discovery due to their ability to differentiate into various specialized cell types. However, iPSCs
are not without challenges. One of the major concerns is genomic instability, which can occur
during the reprogramming process or throughout differentiation. Such genomic abnormalities,
particularly CNVs, can significantly impact the safety, reproducibility, and therapeutic
potential of iPSC-derived lines [@Hussein2011_Nature; @Mayshar2010_CellStemCell; @Laurent2011_CellStemCell].

To ensure the reliability and quality of iPSC-based models, routine genomic screening is
essential. Monitoring for CNVs and other chromosomal aberrations helps to maintain the
genomic integrity of the cell lines. While traditional karyotyping methods are widely used,
they often lack the resolution and efficiency required for high-throughput applications. In
contrast, digital karyotyping provides a robust alternative by using genotyping array data to
detect CNVs at higher resolution [@Danecek2016_PLOSOne].

Digital karyotyping of iPSC lines is widely practiced, but current workflows are fragmented. Labs typically compute CNVs and ROH/LoH with separate tools, then manually stitch tables, screenshots, and scripts to inspect events. This slows review, complicates sharing with collaborators/QA, and undermines reproducibility.

KaryoPlayground fills this gap by standardizing analysis and packaging interpretation into a static, multi-page HTML site (a local web app). It automates preprocessing, CNV and ROH inference, candidate cnLoH highlighting, and QC; and compiles outcomes into a browsable report directory that can be opened locally. Each page provides a one-click “Print to PDF” **button** that preserves the current interactive state (such as zoomed Bokeh plots), and all Bokeh figures support built-in PNG export for publication-ready figures. The Nextflow design ensures transparent provenance and reproducible runs across machines and clusters [@DiTommaso2017_NBT; @Bokeh2018; @Merkel2014_LinuxJournal; @Dykstra2022_Apptainer].

# State of the field

<!-- <<Summarize what other tools exist (e.g., bcftools cnv/roh, GenomeStudio).  
- Say how our tool is different (open-source, interactive HTML, Nextflow reproducibility).>> -->

SNP genotyping arrays such as Illumina Infinium GSA and Thermo Fisher Axiom are a common way to find CNVs and LOHs. Popular tools such as PennCNV and QuantiSNP use two signals from the arrays: log-R ratio (LRR, a measure of intensity) and B-allele frequency (BAF, a measure of genotype balance) [@Wang2007_PennCNV; @Colella2007_QuantiSNP]. These tools work well, but they usually run one sample at a time, have limited ways to check copy-neutral LOH (cnLOH) in one place, and often need extra scripts to plot BAF/LRR next to the calls. Most do not support paired analysis out of the box (for example, comparing a tumor to normal tissue, or an iPSC clone to its parent). Specialized methods like ASCAT address paired allele-specific copy number in cancer, but they target a different use case and ecosystem [@VanLoo2010_PNAS_ASCAT].

Visualization is equally important in cytogenetics and QC workflows, where interpretable, chromosome-by-chromosome views guide decisions. GUI tools like Illumina GenomeStudio/KaryoStudio, Partek Genomics Suite, and Agilent Cytogenomics provide helpful karyograms and per-chromosome BAF/LRR plots [@Illumina_cnvPartition; @GenomeStudio_Docs; @ChAS_Manual; @NexusCopyNumber]. However, they are not open source and can be tied to specific setups, which makes sharing and exact reproducibility harder. Many labs therefore fall back on a mix of in-house pipelines plus IGV or custom plotting for review, fragmenting analysis and interpretation [@Robinson2011_NBT; @Thorvaldsdottir2013_BriefBioinf].

KaryoPlayground is designed to close these gaps with open-source methods. For CNV calling, it uses `bcftools cnv`, which models both BAF and LRR, includes a polysomy mode, and works well for finding differences between two related samples—ideal for our paired PRE$\rightarrow$POST use case [@Danecek2016_PLOSOne]. For runs of homozygosity, it uses `bcftools roh` (an HMM) to detect long homozygous tracts consistent with LOH [@Narasimhan2016_Bioinformatics]. We then overlay ROH with copy-number states: ROH inside diploid (CN=2) regions are flagged as candidate cnLOH, while ROH overlapping CN<2 are labeled as copy-loss LOH. Just as important, we make the results easy to judge: the pipeline shows linked BAF, LRR, and CN tracks (including CN-loss segments) with candidate cnLOH regions clearly highlighted, so investigators can review the evidence directly and make their own decisions rather than rely only on automated calls. This follows established genomic-integrity checks for cell lines and is packaged as a reproducible, containerized Nextflow DSL2 pipeline with a consistent single- and paired-sample workflow [@DiTommaso2017_NBT; @Merkel2014_LinuxJournal; @Dykstra2022_Apptainer].

To make results easy to inspect and share, KaryoPlayground emits a compact, offline interactive HTML report (Bokeh-based) that unifies karyograms, linked BAF/LRR/CN tracks, possible cnLoH region highlightings and QC dashboards with corresponding algorithm's reported quality scores[@Bokeh2018]. Collaborators can open the report directly without a need of special software and can investigate both single and paired analyses in the same layout. 

# Functionality

 Today’s “digital karyotyping” with SNP arrays covers the basics of CNV and LOH detection; however, tools differ in openness, automation, and ease of use. KaryoPlayground stands out by being open source, supporting paired analysis, highlighting cnLOH clearly, and producing shareable interactive reports within a fully reproducible pipeline.

- Single-sample and paired (PRE$\rightarrow$POST) analysis with differential views and event summaries.
- CNV detection (deletions, duplications) from BAF/LRR segmentation with segment statistics and quality scores.
- ROH (HMM) and LOH inference with cnLOH assignment via CN==2 $\cap$ ROH; copy-loss LOH via CN<2 $\cap$ ROH.
- Interactive multi-page HTML (local web app): genome-wide karyograms; synchronized BAF/LRR/CN per chromosome; candidate cnLOH highlighting; QC dashboards; searchable/exportable tables [@Bokeh2018].
- Exportability for review & publication: per-page Print-to-PDF (preserves current zoom/selection) and built-in PNG export on each plot.
- Reproducibility: Nextflow DSL2 + containers (Apptainer/Singularity, Docker); automatic capture of software versions, parameters, and resources; portable artifacts [@DiTommaso2017_NBT; @Dykstra2022_Apptainer; @Merkel2014_LinuxJournal].
- HPC-friendly execution: SLURM templates; optional on-the-fly conda environments for modules where desired.

![Interactive HTML report homepage. The self-contained report displays navigation menu, QC summary metrics, and sample overview for paired PRE$\rightarrow$POST analysis. The report runs locally in any modern web browser without additional software dependencies.\label{fig:homepage}](figures/Home_Page.png)

![Genome-wide karyograms in paired analysis mode. CNV segments are color-coded (deletions in blue, duplications in red) with circle size indicating event magnitude and opacity reflecting statistical significance. The synchronized PRE (donor) and POST (iPSC) views facilitate rapid identification of acquired chromosomal alterations.\label{fig:paired_karyograms}](figures/pre_post_diff_karyograms.png)

![Chromosome-level visualization of BAF, LRR, and copy number tracks in paired mode. Interactive plots enable pan-and-zoom navigation with synchronized views of PRE and POST samples. ROH segments and candidate cnLOH regions are highlighted; LRR plots overlay segment boundaries and mean values (orange) to aid deviation assessment. The differential view integrates both samples for direct comparison of genomic events.\label{fig:chr_view}](figures/pre_post_LRR_BAF.png)

<!-- 
**Demo dataset (reproducibility):** We provide exact instructions to reproduce the paper's results using Illumina's **Infinium Global Screening Array v3.0** support files and GenomeStudio exports. Download the support files via Illumina Support and open the corresponding GenomeStudio project (`.bsc`) to export the required tables (and PLINK), then run the pipeline using our `params.yaml` template [@Illumina_GSA_SupportFiles; @GenomeStudio_Docs]. We intentionally use the **full dataset** (no downsampling) to satisfy QC thresholds and keep results representative of real-world use.

Link: https://support.illumina.com/downloads/infinium-global-screening-array-v3-0-support-files.html -->
# Acknowledgements

I thank **Dr. Alena Boos** and **Dr. Thomas Walzthoeni** (Helmholtz Munich Bioinformatics Platform) for supervision and feedback; **Xavier Pastor** for foundational Nextflow implementation; **Dr. Laura Jiménez Barrón**, **Dr. Lucia Trastulla**, and **Michael Ziller** for earlier development and guidance; and the **HPC-Bioinformatics Core Facility** for computational resources and support. We also acknowledge the original CNV/ROH detection work originating from the Max Planck Institute for Psychiatry.

# References